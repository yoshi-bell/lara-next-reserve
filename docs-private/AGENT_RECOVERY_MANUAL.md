# 🟢 メタ定義: このファイルの責務 (AIエージェント用)
> **AIエージェントへの指示 (Prompt Repetition Strategy):** 
> このファイルの指示を確実に遂行するため、このファイルの内容を**「合計2回」**読み込んでください。
> 1回目は全体像の把握、2回目はルールの定着として処理し、その後、次のステップへ進んでください。

*   **役割:** エージェントの「初期化」と「コンテキスト復旧」。プロジェクトの全ドキュメントへの入り口。
*   **読むべきタイミング:** 新しいチャットセッションを開始した直後に「1回のみ」読み込むこと。
*   **思考の優先順位:** 最優先。まずこのファイルに従って自身の「モード」をセットアップせよ。
*   **含まない情報:** 具体的なコードの実装手順（WORKFLOW.md を参照）、詳細なシステム仕様（DEVELOPMENT_PLAN.md を参照）。

---

# AIエージェント復旧マニュアル (Final Version)

## 0. エージェントの役割 (Persona)
あなたは「lara-next-reserve」プロジェクトの リードフルスタックエンジニア です。 あなたのメモリ（コンテキスト）はリセットされましたが、以下の手順を実行することで、前任のエージェントと同じ理解度まで瞬時に復旧し、開発を継続してください。

## 1. 復旧チェックリスト (Recovery Checklist)
以下のステップを順に実行し、各項目の [ ] にチェックを入れながら進めてください。

### ステップ 1: プロジェクトの全体像把握 (High-level Analysis)
*   [ ] **開発ルールの分析 (`DEVELOPMENT_PLAN.md`):**
    *   `docs-private/DEVELOPMENT_PLAN.md` を読み込み、プロジェクトの不変の原則を特定する。
*   [ ] **直近のワークフロー確認 (`WORKFLOW.md`):**
    *   `docs-private/WORKFLOW.md` の「開発ルール」を最優先で遵守すること。
*   [ ] **直近の作業ログ確認 (`DEV_LOG.md`):**
    *   `docs-private/DEV_LOG.md` を読み込み、リファクタリング、プロジェクト名変更、予約データ生成、画像ローカル化、メッセージ日本語化の経緯を特定する。

### ステップ 2: 実装状況の検証 (Code Verification)

#### バックエンド (Laravel):
*   [ ] **コントローラー:** 責務分離済み（`AuthenticatedSession`, `User`, `Register`, `Shop`, `Reservation`, `Favorite`）。
*   [ ] **サービス:** `ReservationService` にビジネスロジック（在庫管理・予約作成）が集約済み。
*   [ ] **バリデーション・メッセージ:** 
    *   全て FormRequest クラスへ移行済み。
    *   認証エラー等のメッセージは `lang/ja/` で一元管理され、ハードコードは排除済み。
*   [ ] **シーディング:** 
    *   `ReservationSeeder` により、全ユーザーに整合性のある予約データ（未来3/過去2）が自動生成される。
    *   店舗画像は `public/images/shops/` でローカル管理されている。
*   [ ] **テスト (100% Green / 網羅的):** 
    *   認証、店舗、予約（空席判定含む）、マイページ、メール、リマインダーのテストが合格済み。

#### フロントエンド (Next.js):
*   [ ] **コンポーネント:** `ReservationForm`, `ReservationCard`, `ShopCard` が分離・最適化済み。
*   [ ] **画像表示:** `unoptimized` プロパティと `NEXT_PUBLIC_BACKEND_URL` の結合により、ローカル環境での画像表示が安定化済み。
*   [ ] **マイページ:** タブUI（予定/履歴）と設定機能が実装済み。

### ステップ 3: 結論の導出と報告
*   [ ] **現状の判定:** プロジェクト全体のリネーム、アセット管理の改善、テスト網羅、メッセージの多言語化対応、ドキュメント同期が完了。

## 2. 重要事項 (Core Rules)
*   **日本語対応:** 全ての思考と応答を日本語で行うこと。
*   **ドキュメントの同期:** 作業完了時は必ず `DEV_LOG.md` を更新し、その内容に基づいて `AGENT_RECOVERY_MANUAL.md` を最新化すること。
*   **Gitコミット:** 日本語メッセージとプレフィックス（`feat:`, `fix:`, `docs:`, `test:`, `chore:` 等）を使用すること。

## 3. 想定される結論 (Hypothesis: 2026-01-28最終更新)

現在のフェーズ: プロジェクト完了・品質強化済み

完了していること:

✅ プロジェクト名を「lara-next-reserve」へ全面移行。
✅ 予約履歴機能および、各ユーザー5件の整合性あるダミー予約データの生成。
✅ 店舗画像のローカル管理化と、フロントエンドでの安定した表示。
✅ 認証エラーメッセージ等の日本語化・一元管理と、セキュリティを考慮した文言調整。
✅ バックエンド全機能のテスト完備（メール・バッチ・空席判定含む）。
✅ ドキュメント構造の改革（メタ定義導入、憲法と設計の分離、Prompt Repetition）。

未完了・次のタスク:

🚀 本番環境へのデプロイメント検討、または保守運用フェーズ。
